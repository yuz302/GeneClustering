setwd("~/PycharmProjects/gene_expre_clustering/")
library(WGCNA)
library(sqldf)
options(stringsAsFactors=F)
dat0=read.table("genes.csv",header=TRUE,sep=",",quote="",dec=".",row.names=1,colClasses=c("id"="character"))
datExpr=t(dat0)
dat0=read.table("genes.csv",header=TRUE,sep=",",quote="",dec=".",row.names=1,colClasses=c("id"="character"))
dat0<-subset(dat0,dat0$std > 0.5)
dat0=read.table("genes.csv",header=TRUE,sep=",",quote="",dec=".",row.names=1,colClasses=c("id"="character"))
dat0<-subset(dat0,std > 0.5)
dat0<-subset(dat0,dat0$std > 0.1)
setwd("/Users/diana/Github/GeneClustering")
dat0=read.table("genes.csv",header=TRUE,sep=",",quote="",dec=".",row.names=1,colClasses=c("id"="character"))
dat0<-subset(dat0,dat0$std > 0.1)
dat0<-subset(dat0,dat0$std > 0.5)
dat0<-subset(dat0,dat0$std > 1)
dat0<-subset(dat0,dat0$std > 0.8)
dat0<-subset(dat0,dat0$std > 0.5)
dat0<-subset(dat0,dat0$std > 0.5)
dat0<-subset(dat0,dat0$std > 0.5)
dat0=read.table("genes.csv",header=TRUE,sep=",",quote="",dec=".",row.names=1,colClasses=c("id"="character"))
dat0<-subset(dat0,dat0$std > 0.7)
dat0=read.table("genes.csv",header=TRUE,sep=",",quote="",dec=".",row.names=1,colClasses=c("id"="character"))
dat0<-subset(dat0,dat0$std > 0.7)
datExpr=t(dat0)
class(datExpr)<-"numeric"
ADJ = adjacency(datExpr,power=6)
dissTOM=TOMdist(ADJ)
hc <- hclust(as.dist(dissTOM),method="average")
dt = cutreeDynamic(hc,distM=dissTOM, deepSplit=4)
source('~/sublime/cutree.R')
is.list(dt)
is.matrix(dt)
is.data.frame(dt)
is.array(dt)
type(dt)
istype(dt)
class(dt)
write.table(dt,file="clus.csv")
df<-data.frame(
row.names=dat0.row.names
)
row.names=row.names(dat0)
df<-data.frame(
row.names=row.names(dat0)
)
write.table(dt,file="clus.csv",)
write.table(dt,file="clus.csv")
write.table(df,file="clus.csv")
df<-data.frame(
row.names=row.names(dat0)
Cluster=c(dt)
df<-data.frame(
row.names=row.names(dat0),
Cluster=c(dt)
)
write.table(df,file="clus.csv")
write.table(df,file="clusters.csv")
df<-data.frame(
Gene=c(row.names(dat0)),
Cluster=c(dt)
)
write.table(df,file="clusters.csv")
write.table(df,file="clusters.csv",sep=",",quote="")
write.table(df,file="clusters.csv",sep=",")
write.table(df,file="clusters.csv",sep=",",row.names=FALSE)
dt = cutreeDynamic(hc,distM=dissTOM, deepSplit=4)
